<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      .userButton{
        margin: 10px;
      }
    </style>
  </head>
  <body>
    <input type="button" onclick="dataCleaningSideBar();" value="<">
    <h3>Keep Rows</h3>
      <input type="button" class="userButton" onclick="topN()" value="Keep Top N Rows">
      <input type="button" class="userButton" onclick="bottomN()" value="Keep Bottom N Rows">
      <br>
    <h3>Remove Rows</h3>
      <input type="button" class="userButton" onclick="removeTopN()" value="Remove Top N Rows">
      <input type="button" class="userButton" onclick="removeBottomN()" value="Remove Bottom N Rows">
      <input type="button" class="userButton" onclick="removeBlankRow()" value="Remove Blank Rows">
      <input type="button" class="userButton" onclick="removeDupliateRow()" value="Remove Duplicate Rows">
      
    <script>
      function topN(){
        const userInput = getNumericInput("Please enter first N rows to keep:");
        if (userInput !== undefined) {
          google.script.run.keepTopNRows(userInput);
        }
      }

      function bottomN(){
        const userInput = getNumericInput("Please enter bottom N rows to keep:");
        if (userInput !== undefined) {
          google.script.run.keepBottomNRows(userInput);
        }
      }

      function removeTopN(){
        const userInput = getNumericInput("Please enter first N rows to remove:");
        if (userInput !== undefined) {
          google.script.run.removeTopNRows(userInput);
        }
      }

      function removeBottomN(){
        const userInput = getNumericInput("Please enter bottom N rows to remove:");
        if (userInput !== undefined) {
          google.script.run.removeBottomNRows(userInput);
        }
      }

      function removeDupliateRow(){
        google.script.run.removeDuplicateRows();
      }

      function removeBlankRow(){
        google.script.run.removeBlankRows();
      }

      function getNumericInput(message) {
        let userInput;
        let isValid = false;
        let numericValue = 0;

        while (!isValid) {
          userInput = prompt(message);
          if (userInput === null) {
            return; 
          }
          userInput = userInput.trim();
          if (userInput !== '' && !isNaN(userInput) && isFinite(userInput)) {
            isValid = true;
            numericValue = parseFloat(userInput);
            break;      
          } 
          else {
            alert("Please enter a valid numeric value!");
          }
        }
        return numericValue;
      }
    </script>
  </body>
</html>

